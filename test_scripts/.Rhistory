library(cmGDM)
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_OK_COMMAdelim.txt"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
siteTestExp <- cmGDM::cm_create_new_experiment(userID = "user123",
userName = "peterw",
experimentName = "Site data tests2",
description = "Test loading of site data files")
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_OK_COMMAdelim.txt"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
### CHANGE THE PATH TO SHOW THE FOLDER IN WHICH YOU HAVE STORED THE DOWNLOADED DATA FILES ####
base_folder <- "/home/peterw/Data_and_Projects/EcoCommons/community-modelling-workflow/test_scripts/testSuiteDriver_Sites.R"
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_OK_COMMAdelim.txt"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_missing_weight.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
### CHANGE THE PATH TO SHOW THE FOLDER IN WHICH YOU HAVE STORED THE DOWNLOADED DATA FILES ####
base_folder <- "/home/peterw/Data_and_Projects/EcoCommons/community-modelling-workflow/test_data/"
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_missing_weight.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_missing_weight.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "weights")
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_missing_weight.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_OK.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
siteTestExp <- cmGDM::cm_create_new_experiment(userID = "user123",
userName = "peterw",
experimentName = "Site data tests2",
description = "Test loading of site data files")
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_equal_OK.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3)
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_equal_OK.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3,
weightType = "richness")
dataTestExp <- cmGDM::cm_create_new_experiment(userID = "user123",
userName = "peterw",
experimentName = "bioData tests",
description = "Run test to validate loading biological data")
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3)
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3,
weightType = "richness")
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
ans$data$siteData$dataTable
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
# Check that the site data table has been updated with richness values as
# weights: expect to see a "weights" column with values 1, 3, 3, 3, 3
print(ans$data$siteData$dataTable)
ans <- cm_load_site_table(thisExperiment = siteTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_OK.csv"),
siteCol = "site",
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "mystery_column")
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
# Check that the site data table has been updated with richness values as
# weights: expect to see a "weights" column with values 1, 3, 3, 3, 3
print(ans$data$siteData$dataTable)
summary(ans)
cm_gdm_summary(ans)
dataTestExp <- cmGDM::cm_create_new_experiment(userID = "user123",
userName = "peterw",
experimentName = "bioData tests Fst",
description = "Run test to validate loading biological data as an Fst")
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
# Check that the site data table has been updated with richness values as
# weights: expect to see a "weights" column with values 1, 1, 1, 2, 2 in column
# named "site_weights"
cat("Site data table:\n")
print(ans$data$siteData$dataTable)
cat("-----------------------------------------\n\n")
# and expect to see weightType and weightsCol values recorded in site data
# information
cat("Site weight parameters:\n")
cat("  Weight type:", ans$data$siteData$weightType, "\n")
cat("  Weights column:", ans$data$siteData$weightsCol, "\n")
cat("-----------------------------------------\n\n")
source("~/Data_and_Projects/EcoCommons/community-modelling-workflow/test_scripts/testSuiteDriver_BioData.R", echo=TRUE)
dataTestExp <- cmGDM::cm_load_site_table(thisExperiment = dataTestExp,
siteFilename = paste0(base_folder, "siteData_weights_custom_user_colname_OK.csv"),
siteCol = 1,
longitudeCol = 2,
latitudeCol = 3,
weightType = "custom",
weightsCol = "site_weights")
ans <- cmGDM::cm_load_community_data(thisExperiment = dataTestExp,
siteCol = 1,
bioFilename = paste0(base_folder, "community_Count_OK.csv"),
dataType = "Abundance",
dissimMeasure = "Bray-Curtis")
# Check that the site data table has been updated with richness values as
# weights: expect to see a "weights" column with values 1, 1, 1, 2, 2 in column
# named "site_weights"
cat("Site data table:\n")
print(ans$data$siteData$dataTable)
cat("-----------------------------------------\n\n")
# and expect to see weightType and weightsCol values recorded in site data
# information
cat("Site weight parameters:\n")
cat("  Weight type:", ans$data$siteData$weightType, "\n")
cat("  Weights column:", ans$data$siteData$weightsCol, "\n")
cat("-----------------------------------------\n\n")
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
# weak North-South
gradient_weak_NS <- c(rep(10, 3), rep(8, 3), rep(6, 3), 5)
# Random
gradient_random <- sample(1:10, 10, replace = TRUE)
# Random
gradient_random <- sample(0:9, 10, replace = TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
pool <- runif(nSites)
pool
sort(pool)
sort(pool, decreasing = TRUE)
pool <- runif(1000)
pool
sum(pool > 0.1)
sum(pool > 0.5)
sum(pool > 0.7)
pool <- runif(1000, 0, maxAbund)
pool
pool <- runif(100, 0, 20)
sum(pool > gradient_strong_NS[1])
pool <- runif(100, 0, 20)
sum(pool > gradient_strong_NS[1])
pool <- runif(100, 0, 20)
sum(pool > gradient_strong_NS[1])
pool <- runif(100, 0, gradient_strong_NS[1] + 1)
sum(pool > gradient_strong_NS[1])
pool <- runif(100, 0, gradient_strong_NS[1] + 5)
sum(pool > gradient_strong_NS[1])
sppGradientType <- c("strong", "weak", "weak", "strong",
"random", "weak", "strong", "random",
"weak", "random", "random", "strong",
"random", "weak", "strong", "random")
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
sum(runif(100, 0, gradient_strong_NS[j] + 5) > gradient_strong_NS[j])
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
i <- 1
sppGradientType[i]
sppGradientType[i] == "strong"
j <- 1
sum(runif(100, 0, gradient_strong_NS[j] + 5) > gradient_strong_NS[j]
)
abundMatrix[j, i] <- sum(runif(100, 0, gradient_strong_NS[j] + 5) > gradient_strong_NS[j])
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
print(rowSums(ifelse(abundMatrix > 0, 1, 0)))
abundMatrix[j, i] <- sample(trunc(0.1*gradient_strong_NS[j]):(5*gradient_strong_NS[j]), 1)  #sum(runif(100, 0, gradient_strong_NS[j]) < gradient_strong_NS[j])
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
abundMatrix[j, i] <- sum(runif(100, 0, gradient_strong_NS[j]) < gradient_strong_NS[j]/10)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
View(abundMatrix)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/make_data.R", echo=TRUE)
write.csv(abundMatrix, "/home/peterw/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/abundance_matrix_1.csv", row.names = FALSE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
testExp$data$biologicalData$dataTable
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Computing/R/gdm_1.4.2.2/R/GDM_Table_Funcs.R", echo=TRUE)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
testExp$data$biologicalData$siteCol
siteColName <- colnames(testExp$data$biologicalData)[testExp$data$biologicalData$siteCol]
colnames(testExp$data$biologicalData)
siteColName <- colnames(testExp$data$biologicalData$dataTable)[testExp$data$biologicalData$siteCol]
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
testExp$data$biologicalData$dissimMeasure
testExp$data$biologicalData$dissimMatrix
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
gc()
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
testExp$data$biologicalData$dissimMeasure == "Bray-Curtis"
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
detach("package:cmGDM", unload = TRUE)
library(cmGDM)
source("~/Data_and_Projects/Contract projects/EcoCommons/R-scripts/cmGDM_Worked_Examples/Worked_example_richness_weights/Worked_example_abundance_richness_weights.R", echo=TRUE)
detach("package:cmGDM", unload = TRUE)
cmGDM::cm_gdm_summary(testExp)
cmGDM::cm_performance_plots(thisExperiment = testExp)
